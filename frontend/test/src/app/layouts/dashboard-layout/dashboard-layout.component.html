<div class="dashboard-container">
  <!-- Top Header Bar -->
  <div class="header-bar">
    <!-- Left: Company Name with Dropdown -->
    <div class="header-left">
      @if (selectedCompany()) {
        <div class="company-info">
          <mat-icon class="company-icon">business</mat-icon>
          <div class="company-details">
            <div class="company-name">{{ selectedCompany()!.name }}</div>
            <div class="company-context">Transformation</div>
          </div>
          <mat-icon class="dropdown-icon">arrow_drop_down</mat-icon>
        </div>
      } @else {
        <div class="company-info">
          <mat-icon class="company-icon">business</mat-icon>
          <div class="company-details">
            <div class="company-name">Kein Unternehmen</div>
          </div>
        </div>
      }
    </div>

    <!-- Center: Search Bar -->
    <div class="header-center">
      <div class="search-container">
        <mat-icon class="search-icon">search</mat-icon>
        <input 
          type="text" 
          class="search-input" 
          placeholder="Stakeholder, MaÃŸnahmen suchen..."
        />
      </div>
    </div>

    <!-- Right: Notifications, User, Actions -->
    <div class="header-right">
      <!-- Notifications -->
      <button mat-icon-button class="header-button" matTooltip="Benachrichtigungen">
        <mat-icon [matBadge]="notificationCount()" [matBadgeHidden]="notificationCount() === 0" matBadgeColor="warn" [attr.aria-hidden]="false">notifications</mat-icon>
      </button>

      <!-- User Avatar -->
      <button mat-icon-button class="header-button user-avatar-button" [matMenuTriggerFor]="userMenu">
        <div class="header-avatar">{{ getUserInitials() }}</div>
        <mat-icon class="dropdown-icon">arrow_drop_down</mat-icon>
      </button>
      <mat-menu #userMenu="matMenu">
        <button mat-menu-item (click)="logout()">
          <mat-icon>logout</mat-icon>
          <span>Abmelden</span>
        </button>
      </mat-menu>

      <!-- Action Buttons -->
      <button mat-button class="action-button refresh-button" (click)="refreshData()">
        <mat-icon>refresh</mat-icon>
        Aktualisieren
      </button>
      <button mat-button class="action-button report-button" (click)="exportReport()">
        <mat-icon>download</mat-icon>
        Report
      </button>
    </div>
  </div>

  <!-- Sidebar & Content -->
  <mat-sidenav-container class="sidenav-container">
    <!-- Sidebar -->
    <mat-sidenav
      #sidenav
      mode="side"
      [opened]="sidenavOpened()"
      [mode]="isMobile() ? 'over' : 'side'"
      class="sidenav"
    >
      <div class="sidenav-header">
        <div class="logo-container">
          <span class="logo-text">ChangeReady</span>
          <span class="logo-badge">360</span>
        </div>
      </div>
      
      <mat-nav-list>
        @for (item of navItems; track item.route) {
          <a
            mat-list-item
            [routerLink]="item.route"
            routerLinkActive="active"
            [routerLinkActiveOptions]="{exact: false}"
            (click)="isMobile() && sidenav.close()"
          >
            <mat-icon matListItemIcon>{{ item.icon }}</mat-icon>
            <span matListItemTitle>{{ item.label }}</span>
          </a>
        }
      </mat-nav-list>

      <!-- User Profile Section -->
      <div class="user-profile-section">
        <div class="user-avatar">
          {{ getUserInitials() }}
        </div>
        <div class="user-info">
          <div class="user-name">{{ getUserName() }}</div>
          <div class="user-role">{{ getUserRole() }}</div>
        </div>
      </div>

      <!-- Footer -->
      <div class="sidenav-footer">
        <div class="powered-by">POWERED BY Innovera Consulting</div>
      </div>
    </mat-sidenav>

    <!-- Main Content -->
    <mat-sidenav-content class="content">
      <div class="content-wrapper">
        <router-outlet />
      </div>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>

