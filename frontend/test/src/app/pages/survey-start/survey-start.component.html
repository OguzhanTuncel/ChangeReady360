<div class="survey-start-page">
  <div class="survey-start-container">
    <mat-card class="survey-start-card">
    <mat-card-header>
      <mat-card-title>Umfrage starten</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      @if (error()) {
        <div class="error-message" style="background-color: #ffebee; color: #c62828; padding: 16px; border-radius: 4px; margin-bottom: 16px;">
          <strong>Fehler:</strong> {{ error() }}
        </div>
      }

      <div class="department-selection">
        <h3>Bitte w채hlen Sie Ihre Abteilung:</h3>
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Abteilung ausw채hlen</mat-label>
          <mat-select [value]="department()" (selectionChange)="onDepartmentChange($event.value)" required>
            <mat-option [value]="null" disabled>Bitte w채hlen Sie eine Abteilung</mat-option>
            @for (dept of departments; track dept) {
              <mat-option [value]="dept">{{ departmentDisplayNames[dept] }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <div class="participant-type-selection">
        <h3>Bitte w채hlen Sie Ihre Rolle:</h3>
        <div class="radio-group">
          <label class="radio-option">
            <input
              type="radio"
              name="participantType"
              value="PMA"
              [checked]="participantType() === 'PMA'"
              (change)="onParticipantTypeChange('PMA')"
            />
            <span>PMA (Projektmitarbeiter aktiv an Implementierung)</span>
          </label>
          <label class="radio-option">
            <input
              type="radio"
              name="participantType"
              value="AFFECTED"
              [checked]="participantType() === 'AFFECTED'"
              (change)="onParticipantTypeChange('AFFECTED')"
            />
            <span>Betroffener Mitarbeiter</span>
          </label>
        </div>
      </div>

      <div class="actions">
        <button
          mat-raised-button
          color="primary"
          [disabled]="!department() || !participantType() || isLoading()"
          (click)="startSurvey()"
        >
          @if (isLoading()) {
            Umfrage wird geladen...
          } @else {
            Umfrage starten
          }
        </button>
        <button mat-raised-button class="cancel-button" routerLink="/app/surveys">Abbrechen</button>
      </div>
    </mat-card-content>
    </mat-card>
  </div>
</div>

